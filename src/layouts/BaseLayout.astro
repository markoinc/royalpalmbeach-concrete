---
import { siteConfig } from '../config/site';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
  title?: string;
  description?: string;
  canonical?: string;
  schema?: object[];
  noindex?: boolean;
}

const { 
  title = `${siteConfig.name} | Driveways, Patios & Slabs`,
  description = `Premium concrete contractor in ${siteConfig.address.city}, FL. Expert driveways, patios, slabs & stamped concrete. Licensed & insured. Free estimates! Call ${siteConfig.phone}`,
  canonical = Astro.url.pathname,
  schema = [],
  noindex = false,
} = Astro.props;

const fullUrl = `${siteConfig.url}${canonical}`;

const localBusinessSchema = {
  "@context": "https://schema.org",
  "@type": "LocalBusiness",
  "@id": siteConfig.url,
  "name": siteConfig.name,
  "image": `${siteConfig.url}/images/og-image.jpg`,
  "telephone": siteConfig.phone,
  "email": siteConfig.email,
  "url": siteConfig.url,
  "address": {
    "@type": "PostalAddress",
    "addressLocality": siteConfig.address.city,
    "addressRegion": siteConfig.address.state,
    "postalCode": siteConfig.address.zip,
    "addressCountry": "US"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": siteConfig.geo.lat,
    "longitude": siteConfig.geo.lng
  },
  "openingHoursSpecification": [
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
      "opens": "07:00",
      "closes": "18:00"
    },
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": "Saturday",
      "opens": "08:00",
      "closes": "16:00"
    }
  ],
  "priceRange": "$$",
  "areaServed": siteConfig.serviceAreas.map(area => ({
    "@type": "City",
    "name": area.name
  }))
};

const allSchemas = [localBusinessSchema, ...schema];
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content={description}>
  {noindex && <meta name="robots" content="noindex, nofollow">}
  
  <title>{title}</title>
  
  <link rel="canonical" href={fullUrl}>
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/images/favicon-192.png">
  <link rel="apple-touch-icon" href="/images/favicon-192.png">
  
  <!-- Open Graph -->
  <meta property="og:title" content={title}>
  <meta property="og:description" content={description}>
  <meta property="og:url" content={fullUrl}>
  <meta property="og:type" content="website">
  <meta property="og:image" content={`${siteConfig.url}/images/og-image.jpg`}>
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content={title}>
  <meta name="twitter:description" content={description}>
  
  <!-- Schema.org -->
  <script type="application/ld+json" set:html={JSON.stringify(allSchemas)}></script>
  
  <!-- Preconnect -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body class="flex flex-col min-h-screen">
  <Header />
  
  <main class="flex-grow">
    <slot />
  </main>
  
  <Footer />
  
  <!-- Sticky Mobile CTA -->
  <div class="sticky-cta">
    <a href={`tel:${siteConfig.phoneRaw}`} class="flex items-center justify-center gap-3 bg-primary text-white py-3 rounded-lg font-bold text-lg pulse-gold">
      <svg class="w-6 h-6 animate-phone" fill="currentColor" viewBox="0 0 24 24">
        <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
      </svg>
      Tap to Call - Free Quote!
    </a>
  </div>
</body>
</html>

<!-- Sticky Mobile CTA -->
<div class="fixed bottom-0 left-0 right-0 bg-primary-600 text-white py-3 px-4 flex items-center justify-center gap-3 md:hidden z-50 shadow-lg">
  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
  </svg>
  <a href="tel:+15617820848" class="font-bold">Tap to Call: (561) 782-0848</a>
</div>
